{% load wagtailimages_tags %}

{% image self.image max-500x500 as self_image %}

{% if format == 'amp' %}

<amp-img src="{{self_image.url}}"
layout="responsive" width="{{self_image.width}}" height="{{self_image.height}}"
class="{{self.custom_css_class}}"
{% if self.custom_css_id %}id="{{self.settings.custom_css_id}}"{% endif %}
alt="{{self_image.image.title}}"></amp-img>

{% else %}

<div
    class="squared {{self.settings.custom_css_class}}"
    style="background: url({{self_image.url}}) no-repeat; background-size: cover"
    {% if self.custom_css_id %}id="{{self.settings.custom_css_id}}"{% endif %}
    title="{{self_image.image.title}}"
></div>
{% endif %}